--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 6.5.805
--   Created On : samedi, 08 juillet, 2017 
--   DBMS       : Oracle 
--   -------------------------------------------------- 

USE DATABASE Oracle
;


--  Drop Tables, Stored Procedures and Views 
DROP TABLE Affecter CASCADE CONSTRAINTS
;
DROP TABLE AlimentsBase CASCADE CONSTRAINTS
;
DROP TABLE ComposantPlat CASCADE CONSTRAINTS
;
DROP TABLE Composer CASCADE CONSTRAINTS
;
DROP TABLE Constituer CASCADE CONSTRAINTS
;
DROP TABLE Contrainte CASCADE CONSTRAINTS
;
DROP TABLE Dejeuner CASCADE CONSTRAINTS
;
DROP TABLE Diner CASCADE CONSTRAINTS
;
DROP TABLE Familles CASCADE CONSTRAINTS
;
DROP TABLE Formes CASCADE CONSTRAINTS
;
DROP TABLE GroupePatients CASCADE CONSTRAINTS
;
DROP TABLE Ingredient CASCADE CONSTRAINTS
;
DROP TABLE JoinContrainteToAlimentsBase CASCADE CONSTRAINTS
;
DROP TABLE JoinIngredientToAlimentsBase CASCADE CONSTRAINTS
;
DROP TABLE Menu CASCADE CONSTRAINTS
;
DROP TABLE Patient CASCADE CONSTRAINTS
;
DROP TABLE PetitDejeuner CASCADE CONSTRAINTS
;
DROP TABLE Plat CASCADE CONSTRAINTS
;
DROP TABLE Subir CASCADE CONSTRAINTS
;
DROP TABLE Textures CASCADE CONSTRAINTS
;

--  Create Tables 
CREATE TABLE Affecter ( 
	groupePatientsID Integer,
	contrainteID Integer
)
;

CREATE TABLE AlimentsBase ( 
	alimentBase VARCHAR2(50),    --  Blé Gluten Sel Poivre Arachide Soja Lait 
	alimentsBaseID Integer NOT NULL
)
;

COMMENT ON COLUMN AlimentsBase.alimentBase
    IS 'Blé Gluten Sel Poivre Arachide Soja Lait'
;

CREATE TABLE ComposantPlat ( 
	quantite int,
	unite VARCHAR2(50),
	composantPlatID Integer NOT NULL
)
;

CREATE TABLE Composer ( 
	platID Integer,
	ingredientID Integer
)
;

CREATE TABLE Constituer ( 
	menuID Integer,
	platID Integer
)
;

CREATE TABLE Contrainte ( 
	contrainteID int NOT NULL,
	nature Natures,
	nom VARCHAR2(50),
	famille Integer,
	forme Integer,
	texture Integer
)
;

CREATE TABLE Dejeuner ( 
	dejeunerID Integer NOT NULL
)
;

CREATE TABLE Diner ( 
	dinerID Integer NOT NULL
)
;

CREATE TABLE Familles ( 
	famille VARCHAR2(50),
	famillesID Integer NOT NULL
)
;
COMMENT ON TABLE Familles
    IS 'Crustacès Fruits à coque'
;

CREATE TABLE Formes ( 
	forme VARCHAR2(50),    --  Liquide Solide Gélifiée 
	formesID Integer NOT NULL
)
;

COMMENT ON COLUMN Formes.forme
    IS 'Liquide Solide Gélifiée'
;

CREATE TABLE GroupePatients ( 
	groupePatientsID int NOT NULL,
	nom VARCHAR2(50)
)
;

CREATE TABLE Ingredient ( 
	alimentDeBase boolean,
	ingredientID int NOT NULL,
	nom VARCHAR2(50),
	famille Integer,
	forme Integer,
	texture Integer
)
;

CREATE TABLE JoinContrainteToAlimentsBase ( 
	alimentsBaseID Integer,
	contrainteID Integer
)
;

CREATE TABLE JoinIngredientToAlimentsBase ( 
	alimentsBaseID Integer,
	ingredientID Integer
)
;

CREATE TABLE Menu ( 
	date Date,
	menuID int NOT NULL,
	estConsommeParGroupePatient Integer
)
;

CREATE TABLE Patient ( 
	age int,
	chambre int,
	nom VARCHAR2(50),
	patientID int NOT NULL,
	poids int,
	prenom VARCHAR2(50),
	service VARCHAR2(50),
	sexe boolean,
	taille int,
	formeGroupePatient Integer
)
;

CREATE TABLE PetitDejeuner ( 
	petitDejeunerID Integer NOT NULL
)
;

CREATE TABLE Plat ( 
	nom VARCHAR2(50),
	platID int NOT NULL
)
;

CREATE TABLE Subir ( 
	patientID Integer,
	contrainteID Integer
)
;

CREATE TABLE Textures ( 
	texture VARCHAR2(50),    --  Maintenue Modifiée 
	texturesID Integer NOT NULL
)
;

COMMENT ON COLUMN Textures.texture
    IS 'Maintenue Modifiée'
;


--  Create Primary Key Constraints 
ALTER TABLE AlimentsBase ADD CONSTRAINT PK_AlimentsBase 
	PRIMARY KEY (alimentsBaseID)
;

ALTER TABLE ComposantPlat ADD CONSTRAINT PK_ComposantPlat 
	PRIMARY KEY (composantPlatID)
;

ALTER TABLE Contrainte ADD CONSTRAINT PK_Contrainte 
	PRIMARY KEY (contrainteID)
;

ALTER TABLE Dejeuner ADD CONSTRAINT PK_Dejeuner 
	PRIMARY KEY (dejeunerID)
;

ALTER TABLE Diner ADD CONSTRAINT PK_Diner 
	PRIMARY KEY (dinerID)
;

ALTER TABLE Familles ADD CONSTRAINT PK_Familles 
	PRIMARY KEY (famillesID)
;

ALTER TABLE Formes ADD CONSTRAINT PK_Formes 
	PRIMARY KEY (formesID)
;

ALTER TABLE GroupePatients ADD CONSTRAINT PK_GroupePatients 
	PRIMARY KEY (groupePatientsID)
;

ALTER TABLE Ingredient ADD CONSTRAINT PK_Ingredient 
	PRIMARY KEY (ingredientID)
;

ALTER TABLE Menu ADD CONSTRAINT PK_Menu 
	PRIMARY KEY (menuID)
;

ALTER TABLE Patient ADD CONSTRAINT PK_Patient 
	PRIMARY KEY (patientID)
;

ALTER TABLE PetitDejeuner ADD CONSTRAINT PK_PetitDejeuner 
	PRIMARY KEY (petitDejeunerID)
;

ALTER TABLE Plat ADD CONSTRAINT PK_Plat 
	PRIMARY KEY (platID)
;

ALTER TABLE Textures ADD CONSTRAINT PK_Textures 
	PRIMARY KEY (texturesID)
;



--  Create Foreign Key Constraints 
ALTER TABLE Affecter ADD CONSTRAINT GroupePatients 
	FOREIGN KEY (groupePatientsID) REFERENCES GroupePatients (groupePatientsID)
;

ALTER TABLE Affecter ADD CONSTRAINT Contrainte 
	FOREIGN KEY (contrainteID) REFERENCES Contrainte (contrainteID)
;

ALTER TABLE Composer ADD CONSTRAINT Plat 
	FOREIGN KEY (platID) REFERENCES Plat (platID)
;

ALTER TABLE Composer ADD CONSTRAINT Ingredient 
	FOREIGN KEY (ingredientID) REFERENCES Ingredient (ingredientID)
;

ALTER TABLE Constituer ADD CONSTRAINT Menu 
	FOREIGN KEY (menuID) REFERENCES Menu (menuID)
;

ALTER TABLE Constituer ADD CONSTRAINT Plat 
	FOREIGN KEY (platID) REFERENCES Plat (platID)
;

ALTER TABLE Contrainte ADD CONSTRAINT FK_famille 
	FOREIGN KEY (famille) REFERENCES Familles (famillesID)
;

ALTER TABLE Contrainte ADD CONSTRAINT FK_forme 
	FOREIGN KEY (forme) REFERENCES Formes (formesID)
;

ALTER TABLE Contrainte ADD CONSTRAINT FK_texture 
	FOREIGN KEY (texture) REFERENCES Textures (texturesID)
;

ALTER TABLE Dejeuner ADD CONSTRAINT FK_Dejeuner_Menu 
	FOREIGN KEY (dejeunerID) REFERENCES Menu (menuID)
;

ALTER TABLE Diner ADD CONSTRAINT FK_Diner_Menu 
	FOREIGN KEY (dinerID) REFERENCES Menu (menuID)
;

ALTER TABLE Ingredient ADD CONSTRAINT FK_famille 
	FOREIGN KEY (famille) REFERENCES Familles (famillesID)
;

ALTER TABLE Ingredient ADD CONSTRAINT FK_forme 
	FOREIGN KEY (forme) REFERENCES Formes (formesID)
;

ALTER TABLE Ingredient ADD CONSTRAINT FK_texture 
	FOREIGN KEY (texture) REFERENCES Textures (texturesID)
;

ALTER TABLE JoinContrainteToAlimentsBase ADD CONSTRAINT AlimentsBase 
	FOREIGN KEY (alimentsBaseID) REFERENCES AlimentsBase (alimentsBaseID)
;

ALTER TABLE JoinContrainteToAlimentsBase ADD CONSTRAINT Contrainte 
	FOREIGN KEY (contrainteID) REFERENCES Contrainte (contrainteID)
;

ALTER TABLE JoinIngredientToAlimentsBase ADD CONSTRAINT AlimentsBase 
	FOREIGN KEY (alimentsBaseID) REFERENCES AlimentsBase (alimentsBaseID)
;

ALTER TABLE JoinIngredientToAlimentsBase ADD CONSTRAINT Ingredient 
	FOREIGN KEY (ingredientID) REFERENCES Ingredient (ingredientID)
;

ALTER TABLE Menu ADD CONSTRAINT Consommer 
	FOREIGN KEY (estConsommeParGroupePatient) REFERENCES GroupePatients (groupePatientsID)
;

ALTER TABLE Patient ADD CONSTRAINT Former 
	FOREIGN KEY (formeGroupePatient) REFERENCES GroupePatients (groupePatientsID)
;

ALTER TABLE PetitDejeuner ADD CONSTRAINT FK_PetitDejeuner_Menu 
	FOREIGN KEY (petitDejeunerID) REFERENCES Menu (menuID)
;

ALTER TABLE Subir ADD CONSTRAINT Patient 
	FOREIGN KEY (patientID) REFERENCES Patient (patientID)
;

ALTER TABLE Subir ADD CONSTRAINT Contrainte 
	FOREIGN KEY (contrainteID) REFERENCES Contrainte (contrainteID)
;
